package sailpoint;

import com.jayway.jsonpath.JsonPath;
import net.minidev.json.JSONArray;


public class jsonPathIMA {
public static void main(String[] args) throws InterruptedException {
   	String linkIdResbody = "{\"d\": {\"results\": [{\"__metadata\": {\"id\": \"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405774,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\",\"uri\": \"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405774,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\",\"type\": \"IdMRestModel.ER_MXREF_MX_PRIVILEGEET_MX_PRIVILEGEEntryReference\"},\"TASK_GUID\": \"79d105b7-5d67-4d90-9af2-549d739cdc7d\",\"LINK_ID\": 4405774,\"REFERENCED_ID\": 25445,\"REFERENCED_MSKEYVALUE\": \"MX_PRIV:IDS:MANAGE\",\"REFERENCED_DISPLAY_NAME\": \"MX_PRIV:IDS:MANAGE\",\"REFERENCED_DESCRIPTION\": null,\"REFERENCED_ENTRYTYPE\": \"MX_PRIVILEGE\",\"VALID_FROM\": null,\"VALID_TO\": null,\"REASON\": \"New assignment requested from IdentityNow\",\"STATE\": 1,\"STATE_TEXT\": \"OK\",\"DIRECTLY_ASSIGNED\": true,\"INHERITED\": false,\"OPERATION\": \"0\",\"CONTEXT\": {\"__metadata\": {\"type\": \"IdMRestModel.CONTEXT\"},\"CONTEXT_ID\": null,\"CONTEXT_DISPLAY_NAME\": null,\"CONTEXT_ENTRYTYPE_DISPLAY_NAME\": null},\"DIRECT_VALID_FROM\": null,\"DIRECT_VALID_TO\": null,\"CURRENT_VALID_FROM\": null,\"CURRENT_VALID_TO\": null,\"ASSIGNED_AT\": null,\"ASSIGNED_BY\": null,\"STATUS\": 0,\"CONTEXT_MSKEY\": null,\"CONTEXT_MSKEYVALUE\": null,\"REFERENCED_ENTRY\": {\"__deferred\": {\"uri\": \"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405774,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/REFERENCED_ENTRY\"}},\"CONTEXT_ENTRY\": {\"__deferred\": {\"uri\": \"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405774,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/CONTEXT_ENTRY\"}},\"HIERARCHY\": {\"__deferred\": {\"uri\": \"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405774,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/HIERARCHY\"}},\"ASSIGNMENT_HISTORY\": {\"__deferred\": {\"uri\": \"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405774,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d'\\/ASSIGNMENT_HISTORY\"}}},{\"__metadata\": {\"id\": \"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405769,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\",\"uri\": \"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405769,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\",\"type\": \"IdMRestModel.ER_MXREF_MX_PRIVILEGEET_MX_PRIVILEGEEntryReference\"},\"TASK_GUID\": \"79d105b7-5d67-4d90-9af2-549d739cdc7d\",\"LINK_ID\": 4405769,\"REFERENCED_ID\": 1193473,\"REFERENCED_MSKEYVALUE\": \"PRIV:ROLE:QEC100:ZCECC_:DISPLAY_ALL_ADCC__:F160\",\"REFERENCED_DISPLAY_NAME\": \"ZCECC_:DISPLAY_ALL_ADCC__:F160-Role (QEC100)\",\"REFERENCED_DESCRIPTION\": null,\"REFERENCED_ENTRYTYPE\": \"MX_PRIVILEGE\",\"VALID_FROM\": null,\"VALID_TO\": null,\"REASON\": \"New assignment requested from IdentityNow\",\"STATE\": 512,\"STATE_TEXT\": \"Pending\",\"DIRECTLY_ASSIGNED\": true,\"INHERITED\": false,\"OPERATION\": \"0\",\"CONTEXT\": {\"__metadata\": {\"type\": \"IdMRestModel.CONTEXT\"},\"CONTEXT_ID\": null,\"CONTEXT_DISPLAY_NAME\": null,\"CONTEXT_ENTRYTYPE_DISPLAY_NAME\": null},\"DIRECT_VALID_FROM\": null,\"DIRECT_VALID_TO\":null,\"CURRENT_VALID_FROM\":null,\"CURRENT_VALID_TO\":null,\"ASSIGNED_AT\":null,\"ASSIGNED_BY\":null,\"STATUS\":4,\"CONTEXT_MSKEY\":null,\"CONTEXT_MSKEYVALUE\":null,\"REFERENCED_ENTRY\":{\"__deferred\":{\"uri\":\"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405769,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/REFERENCED_ENTRY\"}},\"CONTEXT_ENTRY\":{\"__deferred\":{\"uri\":\"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405769,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/CONTEXT_ENTRY\"}},\"HIERARCHY\":{\"__deferred\":{\"uri\":\"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405769,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/HIERARCHY\"}},\"ASSIGNMENT_HISTORY\":{\"__deferred\":{\"uri\":\"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405769,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/ASSIGNMENT_HISTORY\"}}},{\"__metadata\":{\"id\":\"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405768,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\",\"uri\":\"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405768,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\",\"type\":\"IdMRestModel.ER_MXREF_MX_PRIVILEGEET_MX_PRIVILEGEEntryReference\"},\"TASK_GUID\":\"79d105b7-5d67-4d90-9af2-549d739cdc7d\",\"LINK_ID\":4405768,\"REFERENCED_ID\":40244,\"REFERENCED_MSKEYVALUE\":\"PRIV:ROLE:QSO:Internal_Role\",\"REFERENCED_DISPLAY_NAME\":\"Internal_Role-Role(QSO)\",\"REFERENCED_DESCRIPTION\":null,\"REFERENCED_ENTRYTYPE\":\"MX_PRIVILEGE\",\"VALID_FROM\":null,\"VALID_TO\":null,\"REASON\":\"NewassignmentrequestedfromIdentityNow\",\"STATE\":512,\"STATE_TEXT\":\"Pending\",\"DIRECTLY_ASSIGNED\":true,\"INHERITED\":false,\"OPERATION\":\"0\",\"CONTEXT\":{\"__metadata\":{\"type\":\"IdMRestModel.CONTEXT\"},\"CONTEXT_ID\":null,\"CONTEXT_DISPLAY_NAME\":null,\"CONTEXT_ENTRYTYPE_DISPLAY_NAME\":null},\"DIRECT_VALID_FROM\":null,\"DIRECT_VALID_TO\":null,\"CURRENT_VALID_FROM\":null,\"CURRENT_VALID_TO\":null,\"ASSIGNED_AT\":null,\"ASSIGNED_BY\":null,\"STATUS\":4,\"CONTEXT_MSKEY\":null,\"CONTEXT_MSKEYVALUE\":null,\"REFERENCED_ENTRY\":{\"__deferred\":{\"uri\":\"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405768,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/REFERENCED_ENTRY\"}},\"CONTEXT_ENTRY\":{\"__deferred\":{\"uri\":\"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405768,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/CONTEXT_ENTRY\"}},\"HIERARCHY\":{\"__deferred\":{\"uri\":\"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405768,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/HIERARCHY\"}},\"ASSIGNMENT_HISTORY\":{\"__deferred\":{\"uri\":\"http://sapidmq01.ima.intra:50000\\/idmrestapi\\/v2\\/service\\/ER_MXREF_MX_PRIVILEGE(LINK_ID=4405768,TASK_GUID=guid'79d105b7-5d67-4d90-9af2-549d739cdc7d')\\/ASSIGNMENT_HISTORY\"}}}]}}";
	String linkIDJsonPath= "$.d.results[?(@.REFERENCED_ID=='25445')].LINK_ID";
	JSONArray linkIdArray = JsonPath.read(linkIdResbody,linkIDJsonPath);
	Integer linkId = null;
	if (linkIdArray.size() > 0) {
		linkId = (Integer) linkIdArray.get(0);
	}	
	System.out.println("linkId (MX_PRIV:IDS:MANAGE) : " + linkId);

	linkIdResbody="{\"ER_MXREF_MX_PRIVILEGE\":[{\"LINK_ID\":1562345,\"REASON\":\"Delete requested from IdentityNow\",\"OPERATION\":\"DEL\"}]}";
	String entitlementIDJsonPath= "$.ER_MXREF_MX_PRIVILEGE[*].LINK_ID";
	JSONArray entitlementIDArray = JsonPath.read(linkIdResbody,entitlementIDJsonPath);
	Integer entitlement = null;
	if (entitlementIDArray.size() > 0) {
		entitlement = (Integer) entitlementIDArray.get(0);
	}	
	System.out.println("entitlement: " + entitlement);
    }
}

